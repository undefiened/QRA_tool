(()=>{"use strict";class e{#e;#t;#i;#s;#n;#o;#r;#a;#l;#d;#h;#u;#p;#g;#c;#m;#L;#f;constructor(e,t,i){return this.#e=t,this.#t=!1,this.#i=null,this.#s=!1,this.#n=null,this.#o=!0,this.#r=L.marker(e,{draggable:!0,autoPan:!0}),this.#a=i,this.#l=[],this.#u=0,this.#r.on("moveend",this.#C.bind(this)),this.#g=this.#y(),this.#r.bindPopup(this.#g),this.#E(),this.#x(),this}#x(){this.#d=turf.circle(Object.values(this.#r.getLatLng()).toReversed(),this.#e/2,{units:"meters"}),this.#h=Math.PI*(this.#e/2)**2}#E(){this.#p=turf.point(Object.values(this.#r.getLatLng()).toReversed())}#y(){let e=document.createElement("popup-div"),t=document.createElement("p");t.innerHTML="Altitude",this.#m=document.createElement("slider-div"),this.#f=document.createElement("button"),this.#L=document.createElement("button"),this.#c=document.createElement("input");let i=document.createElement("label"),s=document.createElement("div");e.style.display="flex",e.style.flexDirection="column",this.#m.id="slider",this.#m.style.width="200px",noUiSlider.create(this.#m,{start:[this.#e],step:1,tooltips:{to:e=>Math.round(e)},connect:"lower",range:{min:10,max:1200}}),e.appendChild(this.#m),this.#m.noUiSlider.on("change",this.#b.bind(this)),e.appendChild(t),this.#L.innerHTML="Split segment",this.#L.style.color="BlueViolet",this.#L.style.background="white",this.#L.style.borderRadius="6px",e.appendChild(this.#L),e.appendChild(document.createElement("br")),this.#f.innerHTML="Remove waypoint",this.#f.style.color="Tomato",this.#f.style.background="white",this.#f.style.borderRadius="6px",e.appendChild(this.#f),e.appendChild(document.createElement("br")),this.#c.type="checkbox",this.#c.name="smooth",this.#c.checked=!0,i.innerHTML="Smooth altitude change";let n=document.createElement("i");n.className="fa-regular fa-circle-question",n.setAttribute("data-bs-toggle","tooltip"),n.setAttribute("title","Emulate how drone smoothly changes the altitude between two waypoints with the rate of 90 m altitude change per 1km of horizontal distance. When disabled, a sharp transition occurs."),new bootstrap.Tooltip(n);let o=document.createElement("sup");return o.appendChild(n),i.appendChild(o),i.for="smooth",i.style.paddingRight="10px",this.#c.addEventListener("change",this.#A.bind(this)),s.style.color="blue",i.style.color="black",s.appendChild(i),s.appendChild(this.#c),e.appendChild(s),e}#C(e){this.#r=e.target,this.#x(),this.#E();for(let e of this.#l)e.update()}#b(e,t){this.#e=Math.floor(e[t]),this.#x(),this.#t&&(this.#i.altitude=this.#e,this.#i.altitudeManuallyChanged=!0,this.#i.update()),this.#l.length>0&&this.#l[0].nodesList[0].isSmooth&&this.#l[0].update()}#A(e){this.#t&&(this.#o=0==this.#o,this.#i.update())}hasEdge(){return this.#t}hasNextCicle(){return this.#s}altitudeUpdatedGlobally(e){this.#e=e,this.#m.noUiSlider.set(e),this.#x()}get altitude(){return this.#e}get nextCicle(){return this.#n}get isSmooth(){return this.#o}get marker(){return this.#r}get splitButtonElement(){return this.#L}get removeButtonElement(){return this.#f}get smoothCheckboxElement(){return this.#c}get sliderElement(){return this.#m}get circle(){return this.#d}get circleArea(){return this.#h}get circleCoveredPopulation(){return this.#u}get point(){return this.#p}get edge(){return this.#i}get edgesList(){return this.#l}get positionInList(){return this.#a}set edge(e){this.#i=e,this.#t=!!e}set nextCicle(e){this.#n=e,this.#s=!!e}set positionInList(e){this.#a=e}set circleCoveredPopulation(e){this.#u=e}}class t{#e;#S;#M;#B;#v;#N;#k;#a;#U;#_;#w;#G;#I;#J;#T;#D;#R;#O;#P;#q;#z;#F;constructor(e,t,i,s,n){this.#e=i,this.#S=s,this.#v=0,this.#B=0,this.#N=[],this.#k=0,this.#T=8.34,this.#a=n,this.#D=0,this.#R=0,this.#O=0,this.#q=[e,t],this.#z=0,this.#F=!1,this.#j()}#j(){let[e,t]=this.#q,[i,s]=[Object.values(e.marker.getLatLng()),Object.values(t.marker.getLatLng())];this.#_=colorNameList.pop().hex,this.#U=new L.Polyline([i,s],{color:this.#_,weight:20,opacity:.9,smoothFactor:1}),e.edge=this,e.edgesList.push(this),t.edgesList.push(this),this.#W()}#H(t,i){let s=turf.bearing(t.point,i.point),n=turf.destination(i.point,this.#z,s,{units:"meters"});return new e(n.geometry.coordinates.toReversed(),i.altitude,-1)}#W(){let[e,t]=this.#q;this.#O=turf.distance(e.point,t.point,{units:"meters"});let i=null;this.#z>0&&(i=this.#H(e,t));let s=[Object.values(e.marker.getLatLng()),Object.values(t.marker.getLatLng())];!(this.#z>0)||(s[1]=Object.values(i.marker.getLatLng())),this.#U.setLatLngs(s),this.#I=turf.buffer(this.#U.toGeoJSON(),this.#S,{units:"meters"}),this.#J=turf.area(this.#I,{units:"meters"});let n=Math.abs(t.altitude-e.altitude)/90*1e3,o=this.#O>=n&&t.altitude!=e.altitude;if(e.isSmooth&&o){let s=(this.#O-n)/this.#O,o=this.#X(s),r=L.polygon(o.map((function(e){return e.geometry.coordinates.toReversed()})),{color:"purple",weight:6,opacity:.5,smoothFactor:1}),a=turf.union(e.circle,r.toGeoJSON()),l=this.#z>0?i:t,d=turf.union(a,l.circle),h=.001;this.#G=turf.buffer(d,h,{units:"meters"})}else this.#G=turf.buffer(this.#U.toGeoJSON(),this.#e/2,{units:"meters"});this.#R=turf.area(this.#G,{units:"meters"}),this.#O+=this.#z}#X(e){let[t,i]=this.#q,s=null,[n,o]=[t.point,i.point],r=turf.bearing(n,o),a=turf.destination(n,t.altitude/2,(r+90)%180,{units:"meters"}),l=turf.destination(n,-t.altitude/2,(r+90)%180,{units:"meters"}),d=turf.destination(o,i.altitude/2,(r+90)%180,{units:"meters"}),h=turf.destination(o,-i.altitude/2,(r+90)%180,{units:"meters"}),u=turf.destination(a,this.#O*e,r,{units:"meters"}),p=turf.destination(l,this.#O*e,r,{units:"meters"});return this.#z>0?(s=this.#H(t,i),[a,u,d,turf.destination(d,this.#z,r,{units:"meters"}),turf.destination(h,this.#z,r,{units:"meters"}),h,p,l]):[a,u,d,h,p,l]}#Y(e,t,i){let s=2*this.#S**2*e*Math.sqrt(this.#T**2+t**2)/(this.#S*this.#J)*i;this.#B=this.#O/this.#T*s,this.#M=60*s*60*1e6}update(){this.#W()}computeNMAC_rate(e,t,i){this.#Y(e,t,i)}get population(){return this.#D}get length(){return this.#O}get groundArea(){return this.#R}get airBufferArea(){return this.#J}get polyline(){return this.#U}get polylineColor(){return this.#_}get groundBuffer(){return this.#G}get airBuffer(){return this.#I}get nodesList(){return this.#q}get altitude(){return this.#e}get NMAC_radius(){return this.#S}get NMAC_rate(){return this.#M}get expectedNMAC(){return this.#B}get NMAC_time(){return this.#v}get NMAC_avg_speeds(){return this.#N}get maxSquarePopulationDensity(){return this.#k}get positionInList(){return this.#a}get extraLength(){return this.#z}get altitudeManuallyChanged(){return this.#F}set population(e){this.#D=e}set altitude(e){this.#e=e}set positionInList(e){this.#a=e}set NMAC_radius(e){this.#S=e}set NMAC_time(e){this.#v=e}set NMAC_avg_speeds(e){this.#N=e}set maxSquarePopulationDensity(e){this.#k=e}set extraLength(e){this.#z=e}set v_UA(e){this.#T=e}set altitudeManuallyChanged(e){this.#F=e}}function i(e){return{fillColor:(t=e.properties.B,t>500?"#800026":t>300?"#BD0026":t>200?"#E31A1C":t>100?"#FC4E2A":t>50?"#FD8D3C":t>20?"#FEB24C":t>10||t>-10?"#FED976":"#FFEDA0"),weight:0,opacity:1,color:"CadetBlue",dashArray:"10",fillOpacity:.5};var t}function s(e){return{fillColor:(t=e.properties.T,t>.01?"#000033":t>.005?"#000066":t>.001?"#000099":t>5e-4?"#0000CC":t>1e-4?"#0033FF":t>5e-5?"#0099FF":t>1e-5?"#00CCFF":t>-10?"#00FFCC":"#FFEDA0"),weight:0,opacity:1,color:"CadetBlue",dashArray:"10",fillOpacity:.5};var t}function n(){return{color:"black",weight:1,opacity:.95}}function o(){return{color:"black",weight:1,opacity:.95}}function r(e,t){let i=[];for(let s of e){let e=turf.bbox(s),n={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]},o=t.search(n).map((e=>e.id));i=i.concat(o)}return i}let a=window["polyclip-ts"];const l="Ground risk";new class{#Z;#q;#l;#V;#$;#K;#Q;#ee;#te;#ie;#se;#ne;#oe;#re;#ae;#S;#le;#T;#de;#he;#ue;#pe;#ge;#ce;#me;#Le;#fe;#Ce;#ye;#Ee;#xe;#be;#D;#Ae;#Se;#Me;#Be;constructor(){this.#Z=200,this.#q=[],this.#l=[],this.#V=L.layerGroup([]),this.#$=L.layerGroup([]),this.#Q=null,this.#ee=null,this.#te=L.layerGroup([]),this.#ie=null,this.#se=null,this.#ne=L.layerGroup([]),this.#oe=0,this.#re=0,this.#ae=0,this.#S=50,this.#le=100,this.#T=8.34,this.#de=document.getElementById("population"),this.#he=document.getElementById("length"),this.#ue=document.getElementById("area"),this.#pe=document.getElementById("exposed-density"),this.#ge=document.getElementById("exposed-length-weight"),this.#ce=document.getElementById("nmac-rate"),this.#me=document.getElementById("totals-table"),this.#Le=document.getElementById("segments-table"),this.#fe=document.getElementById("segment-extension"),this.#Ce=document.getElementById("spinner-container"),this.#D=null,this.#Ae=null,this.#Se=0,this.#Me=!0,this.#Be=null,this.#ve(),this.#Ne(),this.#ke(),this.#Ue(),this.#_e(),this.#we(),this.#Ge(),this.#Ie(),this.#Je()}async#ve(){let e=new Promise(((e,t)=>{$.getJSON("./data/population_stockholm.geojson",(function(i,s,n){"success"===s?e(i):t(error)}))}));try{this.#D=await e}catch(e){console.error("Error fetching data:",e)}if(this.#Me)try{this.#Be=function(e){let t=new RBush,i=e.map(((e,t)=>{let i=e.geometry.coordinates[0][0];return{minX:i[0][0],minY:i[3][1],maxX:i[2][0],maxY:i[1][1],id:t}}));return t.load(i),t}(this.#D.features)}catch(e){console.error("Error creating R-Tree of the data:",e)}}async#Ne(){await this.#ve();let e=L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:20,attribution:'&copy <a href="http://openstreetmap.org">OpenStreetMap</a> &copy; <a href="https://www.lantmateriet.se/en/">Lantmäteriet</a>'}),t=L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:20,attribution:'&copy <a href="http://openstreetmap.org">OpenStreetMap</a> &copy; <a href="https://www.lantmateriet.se/en/">Lantmäteriet</a>'});this.#K=L.map("map",{doubleClickZoom:!1,preferCanvas:!0,layers:[e]}).setView([59.3118,18.0663],11),L.control.layers({[l]:e,"Air risk":t},null,{collapsed:!1}).addTo(this.#K);let n=L.geoJSON(this.#D,{style:i}).addTo(this.#K),o=L.geoJSON(this.#D,{style:s});this.#te.addTo(this.#K),this.#V.addTo(this.#K),this.#$.addTo(this.#K),this.#K.on("baselayerchange",function(e){e.name===l?(o.remove(),this.#ne.remove(),this.#$.remove(),n.addTo(this.#K),this.#te.addTo(this.#K),this.#$.addTo(this.#K)):(n.remove(),this.#te.remove(),this.#$.remove(),o.addTo(this.#K),this.#ne.addTo(this.#K),this.#$.addTo(this.#K))}.bind(this)),this.#K.on("dblclick",this.#Te.bind(this))}#ke(){[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map((function(e){return new bootstrap.Tooltip(e)}))}#Te(i){let s=this.#q.length>0?this.#q[this.#q.length-1].altitude:this.#Z,n=Object.values(i.latlng);const o=new e(n,s,this.#q.length);if(this.#V.addLayer(o.marker),this.#De(o),this.#q.length>0&&(this.#q[this.#q.length-1].nextCicle=o),this.#q.push(o),this.#q.length>1){let[e,i]=this.#q.slice(this.#q.length-2,this.#q.length),s=new t(e,i,e.altitude,this.#S,this.#l.length);this.#fe.checked&&(s.extraLength=this.#le,s.update()),this.#$.addLayer(s.polyline),this.#l.push(s),this.#Re("ground"),this.#Re("air"),this.#Oe([s])}}#De(e){e.smoothCheckboxElement.addEventListener("change",(t=>{e.hasEdge()&&(this.#Re("ground"),this.#Oe([e.edge]))})),e.sliderElement.noUiSlider.on("change",((t,i)=>{this.#Re("ground"),e.hasEdge()&&2===e.edgesList.length&&e.edgesList[0].nodesList[0].isSmooth||!e.hasEdge()&&1===e.edgesList.length&&e.edgesList[0].nodesList[0].isSmooth?this.#Oe(e.edgesList):e.hasEdge()&&this.#Oe([e.edge])})),e.splitButtonElement.addEventListener("click",(()=>{this.#Pe(e)})),e.removeButtonElement.addEventListener("click",(()=>{this.#qe(e)})),e.marker.on("moveend",(t=>{this.#Re("ground"),this.#Re("air"),this.#Oe(e.edgesList)}))}#Pe(i){if(i.hasEdge()){let s=Object.values(i.edge.polyline.getCenter()),n=new e(s,i.altitude,i.positionInList+1),o=null,r=i.edge.nodesList[1];this.#V.addLayer(n.marker),this.#De(n),i.nextCicle=n,n.nextCicle=r,this.#q.splice(i.positionInList+1,0,n),i.edge.nodesList[1]=n,n.edgesList[0]=i.edge,i.edge.update(),1===r.edgesList.length?(r.edgesList.pop(),o=new t(n,r,n.altitude,this.#S,i.edge.positionInList+1)):2===r.edgesList.length&&(o=new t(n,r,n.altitude,this.#S,i.edge.positionInList+1),r.edgesList.reverse(),r.edgesList.pop()),this.#$.addLayer(o.polyline),this.#l.splice(i.edge.positionInList+1,0,o),this.#Re("ground"),this.#Re("air"),this.#Oe([i.edge,o]),this.#q.slice(i.positionInList+2,this.#q.length).map((e=>{e.positionInList+=1})),this.#l.slice(i.edge.positionInList+2,this.#l.length).map((e=>{e.positionInList+=1})),this.#l.slice(i.edge.positionInList,this.#l.length).map((e=>{this.#ze(e)}))}}#qe(e){if(e.hasEdge()&&1===e.edgesList.length)this.#q.splice(0,1),this.#V.removeLayer(e.marker),this.#l.splice(0,1),this.#$.removeLayer(e.edge.polyline),this.#q[0].edgesList.splice(0,1),this.#q.map((e=>{e.positionInList-=1})),this.#l.map((e=>{e.positionInList-=1})),this.#Le.querySelector("tbody").deleteRow(0),this.#Re("ground"),this.#Re("air"),this.#Fe([]),this.#l.map((e=>{this.#ze(e)}));else if(e.hasEdge()||1!==e.edgesList.length){if(2===e.edgesList.length){this.#q.splice(e.positionInList,1),this.#V.removeLayer(e.marker),this.#l.splice(e.edge.positionInList,1),this.#$.removeLayer(e.edge.polyline),this.#Le.querySelector("tbody").deleteRow(e.edge.positionInList);let t=e.edgesList[0].nodesList[0],i=e.edge.nodesList[1];t.nextCycle=i,t.edge.nodesList[1]=i,i.edgesList[0]=t.edge,t.edge.update(),this.#q.slice(e.positionInList,this.#q.length).map((e=>{e.positionInList-=1})),this.#l.slice(e.edge.positionInList,this.#l.length).map((e=>{e.positionInList-=1})),this.#Re("ground"),this.#Re("air"),this.#Oe([t.edge]),this.#l.slice(e.edge.positionInList,this.#l.length).map((e=>{this.#ze(e)}))}}else{this.#q.splice(this.#q.length-1,1),this.#V.removeLayer(e.marker),this.#l.splice(this.#l.length-1,1);let t=e.edgesList[0].nodesList[0];t.edge.polyline.remove(),t.edgesList.pop(),t.edge=null,t.nextCycle=null,this.#Le.querySelector("tbody").deleteRow(this.#l.length),this.#Re("ground"),this.#Re("air"),this.#Fe([])}}#Re(e){"ground"===e&&null!=this.#ee?this.#te.removeLayer(this.#ee):"air"===e&&null!=this.#se&&this.#ne.removeLayer(this.#se);let t=this.#l.map((t=>"ground"===e?t.groundBuffer:t.airBuffer)),i=this.#je(t);"ground"===e?(this.#Q=i,this.#ee=L.geoJSON(i,{style:n}),this.#te.addLayer(this.#ee)):"air"===e&&(this.#ie=i,this.#se=L.geoJSON(i,{style:o}),this.#ne.addLayer(this.#se))}#je(e){let t=this.#q.map((e=>Object.values(e.point.geometry.coordinates.toReversed())));if(console.log("nodesCoordinates: ",JSON.stringify(t,null,2)),this.#l.length>0){let t=a.union(...e.map((e=>e.geometry.coordinates)));return turf.buffer(turf.multiPolygon(t),1e-4,{units:"meters"})}return null}#Fe(e){clearTimeout(this.#Ae),this.#Ae=setTimeout((()=>{this.#Oe(e)}),1e3)}async#Oe(e){if(await this.#ve(),this.#Q){this.#Se<1&&this.#We(),this.#Se++,this.#oe=0,e.map((e=>{e.population=0}));let t=null;if(this.#Me){let i=r(e.map((e=>e.groundBuffer)),this.#Be),s=r(e.map((e=>e.airBuffer)),this.#Be);t=Array.from(new Set(i.concat(s))).map((e=>this.#D.features[e]))}else t=this.#D.features;let i=t.length>1e3?4:1,s=Math.ceil(t.length/i),n=[],o=[],a=[],l=[],d=[],h=[],u=1e4;for(let r=0;r<i;r++){let p=r*s,g=p+s,c=t.slice(p,g),m=new Worker("./src/workers.js"),L=e.map((e=>e.groundBuffer)),f=e.map((e=>e.airBuffer)),C=e.map((e=>{let[t,i]=e.nodesList;return[t.circleCoveredPopulation,i.circleCoveredPopulation]=[0,0],[t.circle,i.circle]}));m.postMessage([c,L,f,C,u]),m.onmessage=function(t){let[s,r,p,g,c]=t.data;if(o.push(s),a.push(r),l.push(p),d.push(g),h.push(c),o.length===i){for(let t=0;t<e.length;t++){let i=e[t];i.population=o.map((e=>e[t])).reduce(((e,t)=>e+t),0),i.maxSquarePopulationDensity=Math.max(...h.map((e=>e[t])))/u;let s=a.map((e=>e[t])),n=s.reduce(((e,t)=>e.map(((e,i)=>e+t[i])))),[r,p]=i.nodesList;r.circleCoveredPopulation=n[0],p.circleCoveredPopulation=n[1];let g=l.map((e=>e[t])).reduce(((e,t)=>e+t),0);i.NMAC_time=g;let c=d.map((e=>e[t]));c=c.flat().filter((e=>e>0)),i.NMAC_avg_speeds=c;let m=c.reduce(((e,t)=>e+t),0)/c.length||0,L=this.#D.features[0].properties.p;i.computeNMAC_rate(g,m,L)}let t=this.#l.reduce((function(e,t){return e.concat(t.NMAC_avg_speeds)}),[]).flat(),i=t.length>0?t.reduce(((e,t)=>e+t),0)/t.length:0,s=this.#l.reduce(((e,t)=>e+t.airBufferArea),0),r=this.#l.reduce(((e,t)=>e+t.NMAC_time),0),p=2*this.#S**2*r*Math.sqrt(this.#T**2+i**2)/(this.#S*s)*this.#D.features[0].properties.p,g=this.#l.reduce(((e,t)=>e+t.length),0);this.#re=g/this.#T*p,this.#ae=g/this.#T,this.#oe=Math.ceil(3600*p*1e6),this.#Se--,this.#Je(),e.map((e=>{this.#ze(e)})),n.forEach((function(e){e.terminate()}))}}.bind(this),n.push(m)}}}#We(){this.#Ce.style.display="block";let e=this.#me.querySelector("tbody").querySelector("tr").querySelectorAll("td");for(let t of e)t.innerHTML='<div class="spinner-grow spinner-grow-sm text-primary" role="status"></div>'}#He(){this.#Ce.style.display="none"}#Xe(){let e=0,t=0;for(let i=0;i<this.#l.length-1;i++){let s=this.#l[i],n=this.#l[i+1];e+=Math.min(s.nodesList[1].circleCoveredPopulation,n.nodesList[0].circleCoveredPopulation),t+=Math.min(s.nodesList[1].circleArea,n.nodesList[0].circleArea)}return[e,t]}#Je(){let e=this.#l.reduce(((e,t)=>e+t.population),0),t=this.#l.reduce(((e,t)=>e+t.length),0),i=this.#l.reduce(((e,t)=>e+t.groundArea),0),[s,n]=this.#Xe();e-=s,i-=n;let o=t?(e/t).toExponential(2):0,r=i?(e/i).toExponential(2):0,a=this.#l.reduce(((e,t)=>Math.max(e,t.maxSquarePopulationDensity)),0),l=i?this.#re.toExponential(2):0,d=this.#ae,h=this.#me.querySelector("tbody").querySelector("tr").querySelectorAll("td"),u=[Math.ceil(t),Math.ceil(d/60),Math.ceil(e),Math.ceil(i),o,r,a,this.#oe,l];if(this.#Se<1){for(let e=0;e<h.length;e++)h[e].textContent=u[e];this.#He()}}#ze(e){let t=this.#Le.querySelector("tbody"),i=t.querySelectorAll("tr"),s=[e.positionInList+1,e.altitude,Math.ceil(e.length),Math.ceil(e.length/this.#T/60)],n=[Math.ceil(e.population),Math.ceil(e.groundArea),(e.population/e.length).toExponential(2),(e.population/e.groundArea).toExponential(2),e.maxSquarePopulationDensity.toExponential(2)],o=[Math.ceil(e.NMAC_rate),e.expectedNMAC.toExponential(2)],r=s.concat(n,o);if(this.#l.length===i.length){let t=i[e.positionInList].querySelectorAll("td");for(let e=0;e<r.length;e++)t[e+1].textContent=r[e];t[0].style.background=e.polylineColor}else{let i=document.createElement("tr"),r=document.createElement("td");r.classList.add("color-column"),r.style.background=e.polylineColor,i.appendChild(r),this.#Ye(i,s,"table-light"),this.#Ye(i,n,"table-warning"),this.#Ye(i,o,"table-primary"),t.appendChild(i)}}#Ye(e,t,i){for(let s=0;s<t.length;s++){const n=document.createElement("td");n.classList.add(i),n.textContent=t[s],e.appendChild(n)}}#Ue(){this.#ye=document.getElementById("nmac-slider"),noUiSlider.create(this.#ye,{start:[this.#S],step:1,connect:"lower",tooltips:{to:e=>Math.round(e)},range:{min:[10],max:[1200]}}),this.#ye.noUiSlider.on("change",this.#Ze.bind(this))}#Ze(e,t){this.#S=Math.floor(e[t]);for(let e of this.#l)e.NMAC_radius=this.#S,e.update();this.#Re("air"),this.#Fe(this.#l)}#_e(){this.#xe=document.getElementById("extension-slider"),noUiSlider.create(this.#xe,{start:[this.#le],step:1,tooltips:{to:e=>Math.round(e)},connect:"lower",range:{min:[0],max:[1200]}}),this.#xe.noUiSlider.on("change",this.#Ve.bind(this)),this.#xe.noUiSlider.disable()}#Ve(e,t){this.#le=Math.floor(e[t]),!this.#fe.checked||this.#$e()}#we(){this.#Ee=document.getElementById("uav-speed-slider"),noUiSlider.create(this.#Ee,{start:[this.#T],step:.1,tooltips:{to:e=>Math.round(60*e*60/1e3)},connect:"lower",range:{min:[1],max:[50]}}),this.#Ee.noUiSlider.on("change",this.#Ke.bind(this))}#Ke(e,t){this.#T=e[t],this.#l.map((e=>{e.v_UA=this.#T})),this.#Fe(this.#l)}#Ge(){this.#be=document.getElementById("global-altitude-slider"),noUiSlider.create(this.#be,{start:[this.#Z],step:1,tooltips:{to:e=>Math.round(e)},connect:"lower",range:{min:[10],max:[1200]}}),this.#be.noUiSlider.on("change",this.#Qe.bind(this))}#Qe(e,t){let i=e[t],s=[];for(let e of this.#l)e.altitudeManuallyChanged||(e.altitude=Math.floor(i),e.nodesList[0].altitudeUpdatedGlobally(i),s.push(e));s.map((e=>e.update()));let n=this.#l[this.#l.length-1];n.altitudeManuallyChanged||(n.nodesList[1].altitudeUpdatedGlobally(i),n.update()),this.#Re("ground"),this.#Fe(s)}#Ie(){this.#fe.addEventListener("change",this.#$e.bind(this))}#$e(e){let t=0;this.#fe.checked?(t=this.#le,this.#xe.noUiSlider.enable()):this.#xe.noUiSlider.disable(),this.#l.map((e=>{e.extraLength=t})),this.#l.map((e=>e.update())),this.#Re("ground"),this.#Re("air"),this.#Fe(this.#l)}}})();